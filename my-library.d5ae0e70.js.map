{"mappings":"oeAAAA,EAAA,S,2CAKA,MAAMC,EAAO,CACXC,QAASC,SAASC,cAAc,YAChCC,MAAOF,SAASC,cAAc,UAC9BE,UAAWH,SAASC,cAAc,oBAClCG,cAAeJ,SAASC,cAAc,wBACtCI,MAAOL,SAASC,cAAc,gBAC9BK,cAAeN,SAASC,cAAc,uBAGlCM,EAASC,IACb,IACE,MAAMC,EAAkBC,aAAaC,QAAQH,GAC7C,OAA2B,OAApBC,OAA2BG,EAAYC,KAAKC,MAAML,E,CACzD,MAAOM,GACPC,QAAQD,MAAM,oBAAqBA,EAAME,Q,GAIvCC,EAA0BX,EAAO,WACjCY,EAAwBZ,EAAO,SAyCrC,SAASa,IAKP,GAJAtB,EAAKC,QAAQsB,UAAUC,IAAI,UAC3BxB,EAAKI,MAAMmB,UAAUE,OAAO,UAE5BzB,EAAKK,UAAUqB,UAAY,GACtBN,EAME,CACL,MAAMO,EAA8BP,EACjCQ,KAAI,EAACC,GAAEA,EAAEC,KAAEA,EAAIC,OAAEA,EAAMC,MAAEA,EAAKC,OAAEA,EAAMC,KAAEA,KAWhC,wCAAwCL,mEACMI,WAAgBD,oEAClCA,2GAXf,IAAlBD,EAAOI,OACH,GAAGJ,EAAO,KACQ,IAAlBA,EAAOI,OACP,GAAGJ,EAAO,OAAOA,EAAO,KACxBA,EAAOI,OAAS,EAChB,GAAGJ,EAAO,OAAOA,EAAO,YACxB,gEACaD,EAAKM,MAAM,EAAG,uEACfF,EAAKG,YAAY,8DAWpCC,KAAK,IACRtC,EAAKK,UAAUkC,mBAAmB,YAAaZ,E,MA7B/C3B,EAAKK,UAAUqB,UAAY,GAC3B1B,EAAKK,UAAUkC,mBACb,aACA,uE,CAiDN,SAASC,IACPxC,EAAKO,MAAMgB,UAAUkB,OAAO,Y,CAlG9BzC,EAAKI,MAAMsC,iBAAiB,SAM5B,WAME,GALA1C,EAAKI,MAAMmB,UAAUC,IAAI,UACzBxB,EAAKC,QAAQsB,UAAUE,OAAO,UAE9BzB,EAAKK,UAAUqB,UAAY,GAEtBL,EAME,CACL,MAAMsB,EAA4BtB,EAC/BO,KAAI,EAACC,GAAEA,EAAEC,KAAEA,EAAIC,OAAEA,EAAMC,MAAEA,EAAKC,OAAEA,EAAMC,KAAEA,KAIhC,wCAAwCL,mEACMI,WAAgBD,oEAClCA,2GALdD,EAAOO,KAAK,mEACdR,EAAKM,MAAM,EAAG,uEACfF,EAAKG,YAAY,8DAWpCC,KAAK,IACRtC,EAAKK,UAAUkC,mBAAmB,YAAaI,E,MAtB/C3C,EAAKK,UAAUqB,UAAY,GAC3B1B,EAAKK,UAAUkC,mBACb,aACA,qE,IAfNvC,EAAKC,QAAQyC,iBAAiB,QAASpB,GACvCtB,EAAKK,UAAUqC,iBAAiB,SA4EhCE,eAA+BC,GAC7B,GAA2B,oBAAvBA,EAAEC,OAAOC,UACX,OAGF,MACMlB,EADOgB,EAAEC,OAAOE,QAAQ,mBACdC,QAAQpB,IAO1Be,eAA0BM,GACxBlD,EAAKM,cAAcoB,UAAY,GAC/B1B,EAAKM,cAAciC,mBAAmB,aAAa,EAAAY,EAAAC,SAASF,EAAKG,QACjE,EAAAC,EAAAF,SAAkBF,EAAKG,K,EARvBE,OADmB,EAAAC,EAAAC,UAAS5B,IAE5B7B,EAAKK,UAAUqC,iBAAiB,QAASF,GACzCxC,EAAKQ,cAAckC,iBAAiB,QAASF,E,IApF/ClB","sources":["src/library.js"],"sourcesContent":["import toggleModal from './js/futer-modal';\nimport writeLocalStorage from './js/localStorageApi';\nimport { filmInfo } from './js/fetchData';\nimport hugeCard from './js/hugeCard-template';\n\nconst refs = {\n  watched: document.querySelector('.watched'),\n  queue: document.querySelector('.queue'),\n  container: document.querySelector('.cards-container'),\n  modaHugelCard: document.querySelector('.modal-film__wrapper'),\n  modal: document.querySelector('[data-modal]'),\n  closeModalBtn: document.querySelector('[data-modal-close]'),\n};\n\nconst getKey = key => {\n  try {\n    const serializedState = localStorage.getItem(key);\n    return serializedState === null ? undefined : JSON.parse(serializedState);\n  } catch (error) {\n    console.error('Get state error: ', error.message);\n  }\n};\n\nconst dataWatchedLocalStorage = getKey('watched');\nconst dataQueueLocalStorage = getKey('queue');\n\nrefs.queue.addEventListener('click', markupLibQueue);\nrefs.watched.addEventListener('click', markupLibWatched);\nrefs.container.addEventListener('click', handleCardClick);\n\nmarkupLibWatched();\n\nfunction markupLibQueue() {\n  refs.queue.classList.add('active');\n  refs.watched.classList.remove('active');\n\n  refs.container.innerHTML = '';\n\n  if (!dataQueueLocalStorage) {\n    refs.container.innerHTML = '';\n    refs.container.insertAdjacentHTML(\n      'afterbegin',\n      '<p class=\"library__empty\">Oops! There`s nothing to show there!</p>'\n    );\n  } else {\n    const dataQueueFromLocalStorage = dataQueueLocalStorage\n      .map(({ id, date, genres, title, poster, vote }) => {\n        const genresString = genres.join(', ');\n        const reliseDate = date.slice(0, 4);\n        const voteToFix = vote.toPrecision(2);\n        return `<div class=\"card-container\" data-id=\"${id}\">\n                  <img src=\"https://image.tmdb.org/t/p/w500${poster}\" alt=\"${title}\" class=\"film-img\" />\n                  <h2 class=\"film-title\">${title}</h2>\n                  <div class=\"info-container\">\n                      <span class=\"film-genres\">${genresString} |</span>\n                      <span class=\"film-relise\">${reliseDate}</span>\n                      <span class=\"lib-modal-film__vote\">${voteToFix}</span>\n                  </div>\n              </div>`;\n      })\n      .join('');\n    refs.container.insertAdjacentHTML('beforeend', dataQueueFromLocalStorage);\n  }\n}\n\nfunction markupLibWatched() {\n  refs.watched.classList.add('active');\n  refs.queue.classList.remove('active');\n\n  refs.container.innerHTML = '';\n  if (!dataWatchedLocalStorage) {\n    refs.container.innerHTML = '';\n    refs.container.insertAdjacentHTML(\n      'afterbegin',\n      '<p class=\"library__empty\">Oops! There`cos nothing to show there!</p>'\n    );\n  } else {\n    const dataWatchedFromLocalStorage = dataWatchedLocalStorage\n      .map(({ id, date, genres, title, poster, vote }) => {\n        const genresString =\n          genres.length === 1\n            ? `${genres[0]}`\n            : genres.length === 2\n            ? `${genres[0]}, ${genres[1]}`\n            : genres.length > 2\n            ? `${genres[0]}, ${genres[1]}, Other`\n            : '';\n        const reliseDate = date.slice(0, 4);\n        const voteToFix = vote.toPrecision(2);\n        return `<div class=\"card-container\" data-id=\"${id}\">\n                  <img src=\"https://image.tmdb.org/t/p/w500${poster}\" alt=\"${title}\" class=\"film-img\" />\n                  <h2 class=\"film-title\">${title}</h2>\n                  <div class=\"info-container\">\n                      <span class=\"film-genres\">${genresString} |</span>\n                      <span class=\"film-relise\">${reliseDate}</span>\n                      <span class=\"lib-modal-film__vote\">${voteToFix}</span>\n                  </div>\n              </div>`;\n      })\n      .join('');\n    refs.container.insertAdjacentHTML('beforeend', dataWatchedFromLocalStorage);\n  }\n}\n\nasync function handleCardClick(e) {\n  if (e.target.className === 'cards-container') {\n    return;\n  }\n\n  const card = e.target.closest('.card-container');\n  const id = card.dataset.id;\n  const info = await filmInfo(id);\n  filmInfoFn(info);\n  refs.container.addEventListener('click', cardModal);\n  refs.closeModalBtn.addEventListener('click', cardModal);\n}\n\nasync function filmInfoFn(info) {\n  refs.modaHugelCard.innerHTML = '';\n  refs.modaHugelCard.insertAdjacentHTML('beforeend', hugeCard(info.data));\n  writeLocalStorage(info.data);\n}\n\nfunction cardModal() {\n  refs.modal.classList.toggle('is-hidden');\n}\n"],"names":["parcelRequire","$ce3726a01b8ab25a$var$refs","watched","document","querySelector","queue","container","modaHugelCard","modal","closeModalBtn","$ce3726a01b8ab25a$var$getKey","key","serializedState","localStorage","getItem","undefined","JSON","parse","error","console","message","$ce3726a01b8ab25a$var$dataWatchedLocalStorage","$ce3726a01b8ab25a$var$dataQueueLocalStorage","$ce3726a01b8ab25a$var$markupLibWatched","classList","add","remove","innerHTML","dataWatchedFromLocalStorage","map","id","date","genres","title","poster","vote","length","slice","toPrecision","join","insertAdjacentHTML","$ce3726a01b8ab25a$var$cardModal","toggle","addEventListener","dataQueueFromLocalStorage","async","e","target","className","closest","dataset","info","$2T8VK","default","data","$4ncHU","$ce3726a01b8ab25a$var$filmInfoFn","$45MhR","filmInfo"],"version":3,"file":"my-library.d5ae0e70.js.map"}